#!/bin/bash
# autorun â€“ toggle auto-execution of menu on login (menu option [18] AUTORUN).

# Load color helpers (install path vs dev path)
if [[ -f /etc/SSHPlus/colors ]]; then
	source /etc/SSHPlus/colors
elif [[ -f /bin/colors ]]; then
	source /bin/colors
elif [[ -f "$(dirname "$0")/colors" ]]; then
	source "$(dirname "$0")/colors"
fi

if grep "menu;" /etc/profile >/dev/null 2>&1; then
	clear
	color_echo "DISABLING AUTO RUN" "green"
	echo ""
	color_echo "Running..." "yellow"
	sed -i '/menu;/d' /etc/profile 2>/dev/null
	echo ""
	color_echo "AUTO EXECUTION OFF!" "red"
	sleep 1.5
else
	clear
	color_echo "ACTIVATING AUTO RUN" "green"
	echo ""
	color_echo "Running..." "yellow"
	grep -v "^menu;" /etc/profile 2>/dev/null >/tmp/tmpass && mv /tmp/tmpass /etc/profile 2>/dev/null
	echo "menu;" >>/etc/profile 2>/dev/null
	echo ""
	color_echo "AUTO RUN ON!" "green"
	sleep 1.5
fi
exec /bin/menu
